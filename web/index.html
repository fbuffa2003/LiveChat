<!DOCTYPE html>
<html lang=en>
    <head>
        <title>Sample App</title>
        <script src="//code.jquery.com/jquery-2.2.4.min.js"></script>
        <script src="//cdn.livechatinc.com/boilerplate/1.0.js"></script>
       
        <link rel="stylesheet" href="//cdn.livechatinc.com/boilerplate/1.0.css">
   
        <script type="text/javascript">
            function getPropertyValue(data, propertyName) {
                return undefined === data[propertyName] ? '' : data[propertyName];
            }
            LiveChat.on("customer_profile", function(data) {
                $('#visitorID').html(getPropertyValue(data, 'id'));
                $('#visitorName').html(getPropertyValue(data, 'name'));
                $('#visitorEmail').html(getPropertyValue(data, 'email'));
                $('#chatID').html(getPropertyValue(data.chat, 'id'));
                $('#groupID').html(getPropertyValue(data.chat, 'groupID'));
                $('#BpmUrl').html(getPropertyValue(data.chat, 'BpmUrl'));
                 
            });
           LiveChat.init();
        </script>
  
    </head>
    <body>
   <script type="text/javascript">
   
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.open('POST', 'http://bglobaldemo.entrydns.org:3333/WS/bpmOnline.asmx?op=ObtenerIDContacto/', true);

            // build SOAP request
            var sr =
                '<?xml version="1.0" encoding="utf-8"?>' +
                '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">' +
                '  <soap:Body>' +
                    '<ObtenerIDContacto xmlns="BGlobalSolutions.com">' +
                      '<Email>alice.phillips@streamdev.co.uk</Email>' +
                    '</ObtenerIDContacto>' +
                  '</soap:Body>' +
               ' </soap:Envelope>'

            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4) {
                    if (xmlhttp.status == 200) {
                        alert('done. use firebug/console to see network response');
                    }
                }
            }
            // Send the POST request
            xmlhttp.setRequestHeader('Content-Type', 'text/xml');
            xmlhttp.send(sr);
            var xmlResponse =xmlhttp.responseXML.documentElement;

            var fullNodeList = xmlResponse.getElementsByTagName("Name");
            alert (fullNodeList);
            for (var i=0; i < fullNodeList.length; i++)
            {
              var eachnode = new Option();
              eachnode.text = fullNodeList[i].childNodes[0].nodeValue;
              eachnode.value = fullNodeList[i].attributes[0].value;
            }
        
    </script>
        
        
        <div class="chat-plugin" id="chatPluginContainer">
            <ul class="chat-plugin__menu">
                <li class="chat-plugin__menu__item chat-plugin__menu__item--active"><a href=""><span class="app-icon app-icon-dashboard" title="Contact"></span></a></li>
            </ul>
            <section class="chat-plugin__content">
                <div class="chat-plugin__content--centered">
                    <p class="chat-plugin__p">
                     Hola!<br/>Seleccione un chat para ver el detalle.
                    </p>
                </div>
                <dl class="chat-plugin__dl">
                    <dt>Visitor ID</dt>
                    <dd id="visitorID"></dd>
                    <dt>Visitor Name</dt>
                    <dd id="visitorName"></dd>
                    <dt>Visitor Email</dt>
                    <dd id="visitorEmail"></dd>
                    <dt>Chat ID</dt>
                    <dd id="chatID"></dd>
                    <dt>Group ID</dt>
                    <dd id="groupID"></dd>
                    <dt>Bpm-Online URL</dt>
                    <dd id="visitorID"><a target="_blank" href="https://0384564-sales-enterprise-marketing-service-enterprise-demo.bpmonline.com/0/Nui/ViewModule.aspx#CardModuleV2/ContactPageV2/edit/a6f14ab1-5ab9-4c85-9c40-8cf5560919cc">Detalle Contacto</a></dd>
                </dl>
            </section>
        </div>
    </body>
</html>
